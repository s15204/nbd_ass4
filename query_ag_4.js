printjson(db.people.aggregate( { "$group": { _id: "$nationality", average_bmi: { $avg: {$multiply: [{ $divide: [{ $toDecimal:"$weight"}, {"$pow":[{ $toDecimal: "$height"}, 2]}]}, 10000]} }, min_bmi: { $min: {$multiply: [{ $divide: [{ $toDecimal:"$weight"}, {"$pow":[{ $toDecimal: "$height"}, 2]}]}, 10000]} }, max_bmi: { $max: {$multiply: [{ $divide: [{ $toDecimal:"$weight"}, {"$pow":[{ $toDecimal: "$height"}, 2]}]}, 10000]} }}}).toArray())